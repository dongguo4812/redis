# 介绍

Redis zset 和set一样也是string类型元素的集合,且不允许重复的成员。

不同的是每个元素都会关联一个double类型的分数,redis正是通过分数来为集合中的成员进行从小到大的排序。因为zset的可排序特性，经常被用来实现排行榜这样的功能。

zset的成员是唯一的，但分数(score)却可以重复。

zset集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是 O(1)。集合中最大的成员数为 2^32 -1

# 常见命令

## ZADD

ZADD key score member：添加一个或多个元素到sorted set ，如果已经存在则更新其score值

```shell
127.0.0.1:6379> zadd zset1 60 v1 50 v2 80 v3 70 v4 90 v5 
(integer) 5
```

## ZRANGE

ZRANGE key start stop [withscores]：按照score排序后，获取指定索引范围内的元素

```shell
127.0.0.1:6379> zrange zset1 0 -1 withscores
 1) "v2"
 2) "50"
 3) "v1"
 4) "60"
 5) "v4"
 6) "70"
 7) "v3"
 8) "80"
 9) "v5"
10) "90"
127.0.0.1:6379> zrange zset1 1 3 withscores
1) "v1"
2) "60"
3) "v4"
4) "70"
5) "v3"
6) "80"
```

## ZREVRANGE

按照score倒序，获取指定索引范围内的元素

```shell
127.0.0.1:6379> zrevrange zset1 0 -1 withscores
 1) "v5"
 2) "90"
 3) "v3"
 4) "80"
 5) "v4"
 6) "70"
 7) "v1"
 8) "60"
 9) "v2"
10) "50"
```

## ZRANGEBYSCORE

ZRANGEBYSCORE key min max [withscores] [limit offset count]：按照score排序后，获取指定score范围内的元素

( 表示大于score

limit 作用是限制返回数量

```shell
127.0.0.1:6379> zrangebyscore zset1 60 80
1) "v1"
2) "v4"
3) "v3"
127.0.0.1:6379> zrangebyscore zset1 60 80 withscores
1) "v1"
2) "60"
3) "v4"
4) "70"
5) "v3"
6) "80"
127.0.0.1:6379> zrangebyscore zset1 (60 80 withscores
1) "v4"
2) "70"
3) "v3"
4) "80"
127.0.0.1:6379> zrangebyscore zset1 60 80 withscores limit 0 2
1) "v1"
2) "60"
3) "v4"
4) "70"

```

## ZSCORE

ZSCORE key member : 获取sorted set中的指定元素的score值

```shell
127.0.0.1:6379> zscore zset1 v1
"60"
```

## ZCARD

获取sorted set中的元素个数

```shell
127.0.0.1:6379> zcard zset1
(integer) 5
```

## ZREM

ZREM key member：删除sorted set中的一个指定元素

```shell
127.0.0.1:6379> zrem zset1 v5
(integer) 1
127.0.0.1:6379> zrange zset1 0 -1 withscores
1) "v2"
2) "50"
3) "v1"
4) "60"
5) "v4"
6) "70"
7) "v3"
8) "80"
```

## ZINCRBY

ZINCRBY key increment member：让sorted set中的指定元素分数自增，步长为指定的increment值

```shell
127.0.0.1:6379> zscore zset1 v1
"60"
127.0.0.1:6379> zincrby zset1 6 v1
"66"
```

## ZCOUNT

ZCOUNT key min max：统计score值在给定范围内的所有元素的个数

```shell
127.0.0.1:6379> zcount zset1 70 90
(integer) 2
127.0.0.1:6379> zrangebyscore zset1 70 90 withscores
1) "v4"
2) "70"
3) "v3"
4) "80"
```

## ZRANK

ZRANK key member：获取sorted set 中的指定元素的索引

```shell
127.0.0.1:6379> zrange zset1 0 -1
1) "v2"
2) "v1"
3) "v4"
4) "v3"
127.0.0.1:6379> zrank zset1 v1
(integer) 1
127.0.0.1:6379> zrank zset1 v2
(integer) 0
```

## ZREVRANK

获取sorted set 中的指定元素倒序的索引

```shell
127.0.0.1:6379> zrevrank zset1 v1
(integer) 2
127.0.0.1:6379> zrevrank zset1 v2
(integer) 3
```

# 应用场景

排行榜

热门商品排序显示
